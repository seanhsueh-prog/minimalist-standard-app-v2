<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Minimalist V13.99 - Demo Final</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* [V13.99 Demo ç©©å®šç‰ˆå‹] */
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; 
            -webkit-font-smoothing: antialiased; 
            background-color: #e5e5e5; /* æ¡Œæ©ŸèƒŒæ™¯ï¼šæ·±ç°ï¼Œå°æ¯”å‡ºæ‰‹æ©Ÿæ¡† */
            color: #111; 
            margin: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
        }
        
        /* æ ¸å¿ƒå®¹å™¨ï¼šæ¨¡æ“¬æ‰‹æ©Ÿ Appï¼Œç½®ä¸­é¡¯ç¤º */
        .app-container {
            width: 100%;
            max-width: 480px; /* é–å®šæ‰‹æ©Ÿå¯¬åº¦ */
            min-height: 100vh;
            background-color: #ffffff;
            position: relative;
            box-shadow: 0 0 40px rgba(0,0,0,0.15); /* æ‡¸æµ®é™°å½± */
            display: flex;
            flex-direction: column;
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in { animation: fade-in 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards; }

        /* 9:16 é»ƒé‡‘æ¯”ä¾‹ç•«å¸ƒ (V13.4/13.5 Hybrid Fix) */
        .ghost-canvas-container {
            position: relative;
            width: 100%;
            aspect-ratio: 9 / 16; /* ç¢ºä¿æ¯”ä¾‹æ­£ç¢º */
            background-color: #f9fafb;
            overflow: hidden;
            border-bottom: 1px solid #f0f0f0;
        }

        .ghost-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: contain; 
            object-position: bottom center; /* ç¢ºä¿é‹å­è²¼åº• */
            pointer-events: none;
            transition: opacity 0.3s ease-in-out;
        }

        /* é¢¨æ ¼æ¨™ç±¤ */
        .style-tag {
            font-size: 9px;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 700;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        .tag-Classic { background: #e5e7eb; color: #374151; }
        .tag-Gentleman { background: #1e3a8a; color: white; }
        .tag-Casual { background: #fef3c7; color: #92400e; }
        .tag-Sport { background: #d1fae5; color: #065f46; }

    </style>
</head>
<body>
    <div id="root" class="w-full flex justify-center"></div>

    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- 1. SEMANTIC STATIC INVENTORY (Hardcoded for Demo Stability) ---
        const generateInventory = () => {
            const items = [];
            let idCounter = 1;

            const addItem = (slot, filename, name, tag, category) => {
                items.push({
                    id: idCounter++,
                    slot,
                    image: `./${filename}.png`,
                    name,
                    tag, 
                    category
                });
            };

            // Outer (o1-o10)
            addItem('outer', 'o1', 'é¨å£«çš®è¡£', 'Classic', 'çš®è¡£');
            addItem('outer', 'o2', 'è¥¿è£å¤–å¥— (é»‘)', 'Gentleman', 'è¥¿è£å¤–å¥—');
            addItem('outer', 'o3', 'è¥¿è£å¤–å¥— (è—)', 'Gentleman', 'è¥¿è£å¤–å¥—');
            addItem('outer', 'o4', 'çŸ­ç‰ˆå¤¾å…‹', 'Casual', 'å¤¾å…‹');
            addItem('outer', 'o5', 'ç¾½çµ¨å¤–å¥—', 'Casual', 'ç¾½çµ¨');
            addItem('outer', 'o6', 'é‹å‹•å¤–å¥—', 'Sport', 'é‹å‹•');
            for(let i=7; i<=10; i++) addItem('outer', `o${i}`, 'ç²¾é¸å¤–å¥—', 'Classic', 'å¤–å¥—');

            // Inner (i1-i10)
            addItem('inner', 'i1', 'è³ªæ„Ÿ T-Shirt (ç™½)', 'Classic', 'Tæ¤');
            addItem('inner', 'i2', 'è³ªæ„Ÿ T-Shirt (é»‘)', 'Classic', 'Tæ¤');
            addItem('inner', 'i3', 'é‡ç¹”è¡«', 'Gentleman', 'é‡ç¹”');
            addItem('inner', 'i4', 'ä¼‘é–’è¥¯è¡«', 'Casual', 'è¥¯è¡«');
            addItem('inner', 'i5', 'è¡›è¡£/å¸½T', 'Casual', 'è¡›è¡£');
            for(let i=6; i<=10; i++) addItem('inner', `i${i}`, 'ç²¾é¸å…§æ­', 'Casual', 'å…§æ­');

            // Bottom (b1-b10)
            addItem('bottom', 'b1', 'ä¿®èº«è¥¿è¤² (é»‘)', 'Gentleman', 'è¥¿è£è¤²');
            addItem('bottom', 'b2', 'ä¿®èº«è¥¿è¤² (ç°)', 'Gentleman', 'è¥¿è£è¤²');
            addItem('bottom', 'b3', 'ä¸¹å¯§ç‰›ä»”è¤²', 'Classic', 'ä¸¹å¯§');
            addItem('bottom', 'b4', 'æ£‰è³ªä¼‘é–’è¤²', 'Casual', 'ä¼‘é–’è¤²');
            addItem('bottom', 'b5', 'é‹å‹•è¤²', 'Sport', 'é‹å‹•è¤²');
            addItem('bottom', 'b6', 'çŸ­è¤²', 'Casual', 'çŸ­è¤²');
            for(let i=7; i<=10; i++) addItem('bottom', `b${i}`, 'ç²¾é¸ä¸‹èº«', 'Casual', 'ä¸‹èº«');

            // Shoes (s1-s10)
            addItem('shoes', 's1', 'æ¥µç°¡å°ç™½é‹', 'Classic', 'çƒé‹');
            addItem('shoes', 's2', 'é‹å‹•é‹', 'Sport', 'çƒé‹');
            addItem('shoes', 's3', 'ç¶“å…¸çš®é‹', 'Gentleman', 'çš®é‹');
            addItem('shoes', 's4', 'è³ªæ„Ÿé´æ¬¾', 'Classic', 'é´å­');
            for(let i=5; i<=10; i++) addItem('shoes', `s${i}`, 'ç²¾é¸é‹æ¬¾', 'Classic', 'é‹æ¬¾');

            return items;
        };

        const STATIC_INVENTORY = generateInventory();

        // --- 2. CONFIG & HELPERS ---
        const DEFAULT_OUTFIT = { coat: null, outer: null, inner: null, bottom: null, shoes: null, bag: null, jewelry: null };

        const SLOTS = [
            { id: 'outer', label: 'å¤–å¥—' },
            { id: 'inner', label: 'å…§æ­' },
            { id: 'bottom', label: 'ä¸‹èº«' },
            { id: 'shoes', label: 'é‹æ¬¾' }
        ];

        const INVENTORY_TABS = [
            { id: 'outer', label: 'å¤–å¥—', slots: ['outer'] },
            { id: 'inner', label: 'å…§æ­', slots: ['inner'] },
            { id: 'bottom', label: 'ä¸‹èº«', slots: ['bottom'] },
            { id: 'shoes', label: 'é‹æ¬¾', slots: ['shoes'] }
        ];

        // --- 3. ICONS ---
        const Icon = ({ name, className }) => {
            const icons = {
                trash: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>,
                check: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="20 6 9 17 4 12"/></svg>,
                dice: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><path d="M16 8h.01"/><path d="M8 8h.01"/><path d="M8 16h.01"/><path d="M16 16h.01"/><path d="M12 12h.01"/></svg>,
                star: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
                x: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            };
            return icons[name] ? React.cloneElement(icons[name], { className }) : null;
        };

        // --- 4. COMPONENTS ---

        const GhostEngine = ({ outfit, onSlotClick }) => {
            const { outer, inner, bottom, shoes } = outfit;
            return (
                <div className="w-full mb-4 flex flex-col items-center animate-fade-in bg-white">
                    <div className="ghost-canvas-container relative">
                        {/* Z-Index: Shoes(10) < Bottom(20) < Inner(30) < Outer(40) */}
                        {shoes && <img src={shoes.image} className="ghost-layer z-10" alt="Shoes" onError={(e) => e.target.style.display='none'} />}
                        {bottom && <img src={bottom.image} className="ghost-layer z-20" alt="Bottom" onError={(e) => e.target.style.display='none'} />}
                        {inner && <img src={inner.image} className="ghost-layer z-30" alt="Inner" onError={(e) => e.target.style.display='none'} />}
                        {outer && <img src={outer.image} className="ghost-layer z-40" alt="Outer" onError={(e) => e.target.style.display='none'} />}
                        
                        {/* Empty State Hint */}
                        {(!shoes && !bottom && !inner && !outer) && (
                            <div className="absolute inset-0 flex items-center justify-center text-gray-300 text-xs tracking-widest">
                                é è¦½å€åŸŸ (V13.99)
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const CritiquePanel = ({ outfit }) => {
            const { outer, inner, bottom, shoes } = outfit;
            
            const analysis = useMemo(() => {
                const items = [outer, inner, bottom, shoes].filter(Boolean);
                if (items.length < 3) return { title: "æº–å‚™å°±ç·’", msg: "è«‹é¸æ“‡å–®å“ï¼ŒAI å°‡ç‚ºæ‚¨åˆ†æé¢¨æ ¼ã€‚", type: "neutral" };

                const tags = items.map(i => i.tag);
                const count = (t) => tags.filter(x => x === t).length;

                // Rules
                if (outer?.tag === 'Classic' && outer?.name?.includes('çš®è¡£') && (bottom?.tag === 'Classic' || bottom?.tag === 'Gentleman')) {
                    return { title: "âœ¨ ç¶“å…¸æ¥µç°¡ (Golden Triangle)", msg: "çš®è¡£çš„ç¡¬æŒºèˆ‡ä¸‹èº«çš„ä¿®èº«å‰ªè£å½¢æˆå®Œç¾å°æ¯”ï¼Œå±•ç¾å¹²å ´æµçš„æ¥µè‡´ç¾å­¸ã€‚", type: "success" };
                }
                if (count('Gentleman') >= 2) {
                    return { title: "ğŸ© ç¾ä»£ç´³å£« (Modern Gentleman)", msg: "æ²ˆç©©çš„å–®å“çµ„åˆï¼Œæ•£ç™¼å‡ºå°ˆæ¥­èˆ‡æˆç†Ÿçš„æ°£è³ªï¼Œé©åˆå•†å‹™æˆ–æ­£å¼ç´„æœƒã€‚", type: "success" };
                }
                if (count('Sport') >= 2) {
                    return { title: "âš¡ éƒ½æœƒé‹å‹• (Urban Sport)", msg: "æ©Ÿèƒ½èˆ‡èˆ’é©å…¼å…·ï¼Œå±•ç¾å……æ»¿æ´»åŠ›çš„éƒ½æœƒä¼‘é–’é¢¨æ ¼ã€‚", type: "info" };
                }
                return { title: "ğŸŒ¿ èˆ’é©ä¼‘é–’ (Relaxed Casual)", msg: "çµæ§‹å”èª¿çš„æ—¥å¸¸æ­é…ï¼Œè‡ªç„¶éš¨æ€§ï¼Œé©åˆé€±æœ«æˆ–è¼•é¬†å ´åˆã€‚", type: "neutral" };

            }, [outfit]);

            return (
                <div className={`mx-6 mb-6 rounded-xl p-4 border shadow-sm transition-all duration-500 animate-fade-in ${analysis.type === 'success' ? 'bg-gray-900 text-white border-gray-800' : 'bg-white text-gray-800 border-gray-200'}`}>
                    <div className="flex items-start gap-3">
                        <div className={`mt-0.5 p-1.5 rounded-full ${analysis.type === 'success' ? 'bg-yellow-500/20 text-yellow-400' : 'bg-gray-100 text-gray-500'}`}>
                            <Icon name="star" className="w-4 h-4" />
                        </div>
                        <div>
                            <h4 className="text-xs font-bold uppercase tracking-widest mb-1">{analysis.title}</h4>
                            <p className="text-xs leading-relaxed opacity-90">{analysis.msg}</p>
                        </div>
                    </div>
                </div>
            );
        };

        // --- 5. MAIN APPLICATION ---
        const App = () => {
            const [wardrobe] = useState(STATIC_INVENTORY);
            const [outfit, setOutfit] = useState(DEFAULT_OUTFIT);
            const [inventoryTab, setInventoryTab] = useState('outer'); 

            const handleRandomStyle = () => {
                const newOutfit = { ...outfit }; 
                const targets = ['outer', 'inner', 'bottom', 'shoes'];
                let filledCount = 0;

                targets.forEach(slot => {
                    if (outfit[slot]) return; 
                    const candidates = wardrobe.filter(item => item.slot === slot);
                    if (candidates.length > 0) {
                        const randomItem = candidates[Math.floor(Math.random() * candidates.length)];
                        newOutfit[slot] = randomItem;
                        filledCount++;
                    }
                });
                
                if (filledCount === 0) {
                    alert("æç¤ºï¼šå…¨èº«å·²ç©¿æ»¿ï¼Œè«‹å…ˆè„«ä¸‹éƒ¨åˆ†å–®å“ï¼ŒAI æ‰èƒ½éš¨æ©Ÿå¡«è£œã€‚");
                } else {
                    setOutfit(newOutfit);
                }
            };

            const handleClearAll = () => {
                setOutfit(DEFAULT_OUTFIT);
            };

            const handleClearSlot = (slot) => {
                setOutfit(prev => ({ ...prev, [slot]: null }));
            };

            // V13.99 Logic: Hide card if image fails loading (Demo Safety)
            const renderItemCard = (item, onClick, isSelected) => {
                return (
                    <div 
                        key={item.id} 
                        onClick={() => onClick(item)} 
                        className={`item-card p-3 bg-white rounded-xl border relative cursor-pointer transition-all ${isSelected ? 'border-black shadow-md ring-1 ring-black' : 'border-gray-100 hover:border-gray-300'}`}
                    >
                        <div className="w-full aspect-[3/4] mb-2 rounded-lg overflow-hidden bg-gray-50 flex items-center justify-center">
                            <img 
                                src={item.image} 
                                className="w-full h-full object-contain"
                                onError={(e) => {
                                    // V13.99 Safety: Hide item if image missing
                                    e.target.closest('.item-card').style.display = 'none';
                                }} 
                            />
                        </div>

                        <div className="flex justify-between items-start mb-1">
                            <span className="text-[9px] font-bold uppercase text-gray-400">{item.slot}</span>
                            <span className={`style-tag tag-${item.tag}`}>{item.tag}</span>
                        </div>
                        <div className="font-bold text-sm text-gray-900 truncate">{item.name}</div>
                        
                        {isSelected && <div className="absolute bottom-2 right-2 text-black"><Icon name="check" className="w-4 h-4"/></div>}
                    </div>
                );
            };

            const currentFilteredWardrobe = wardrobe.filter(item => {
                const activeTab = INVENTORY_TABS.find(t => t.id === inventoryTab);
                return activeTab ? activeTab.slots.includes(item.slot) : true;
            });

            return (
                <div className="app-container">
                    {/* Header */}
                    <div className="px-6 pt-6 pb-4 bg-white border-b border-gray-100 flex justify-between items-center z-10 sticky top-0">
                        <h1 className="text-lg font-bold tracking-tighter flex items-center gap-2">
                            Minimalist 
                            <span className="bg-black text-white text-[10px] px-2 py-0.5 rounded-full shadow-sm">V13.99</span>
                        </h1>
                    </div>

                    <div className="flex-1 overflow-y-auto no-scrollbar relative bg-gray-50">
                        {/* Visualizer */}
                        <GhostEngine outfit={outfit} />
                        
                        {/* Controls: Active Slots */}
                        <div className="px-6 mb-6">
                            <div className="grid grid-cols-4 gap-2 mb-6">
                                {['outer','inner','bottom','shoes'].map(slot => (
                                    <div key={slot} className="relative group">
                                        <div 
                                            onClick={() => setInventoryTab(slot)}
                                            className={`aspect-square rounded-xl border flex flex-col items-center justify-center cursor-pointer transition-all ${outfit[slot] ? 'bg-white border-black' : 'bg-gray-100 border-dashed border-gray-300'}`}
                                        >
                                            <span className="text-[9px] font-bold uppercase text-gray-400 mb-1">{SLOTS.find(s=>s.id===slot)?.label}</span>
                                            {outfit[slot] ? (
                                                <div className={`w-3 h-3 rounded-full bg-black`}></div>
                                            ) : (
                                                <span className="text-xs text-gray-300 font-bold">+</span>
                                            )}
                                        </div>
                                        {outfit[slot] && (
                                            <button 
                                                type="button"
                                                onClick={(e) => { e.stopPropagation(); handleClearSlot(slot); }}
                                                className="absolute -top-2 -right-2 bg-white border border-gray-200 text-gray-400 rounded-full p-1 shadow hover:text-red-500 z-20"
                                            >
                                                <Icon name="x" className="w-3 h-3" />
                                            </button>
                                        )}
                                    </div>
                                ))}
                            </div>

                            <div className="flex gap-3">
                                <button 
                                    type="button"
                                    onClick={handleClearAll}
                                    className="flex-1 py-3 bg-white border border-gray-200 text-gray-500 text-xs font-bold tracking-widest uppercase rounded-xl hover:bg-gray-50 flex items-center justify-center gap-2 active:scale-95 transition-transform"
                                >
                                    <Icon name="trash" className="w-4 h-4" /> å…¨éƒ¨è„«ä¸‹
                                </button>
                                <button 
                                    type="button"
                                    onClick={handleRandomStyle}
                                    className="flex-[2] py-3 bg-black text-white text-xs font-bold tracking-widest uppercase rounded-xl hover:bg-gray-900 shadow-lg flex items-center justify-center gap-2 transition-transform active:scale-95"
                                >
                                    <Icon name="dice" className="w-4 h-4" /> éš¨æ©Ÿè£œä½ (AI)
                                </button>
                            </div>
                        </div>

                        {/* Critique */}
                        <CritiquePanel outfit={outfit} />

                        {/* Inventory Section (Locked for Demo) */}
                        <div className="bg-white rounded-t-3xl shadow-[0_-10px_40px_rgba(0,0,0,0.05)] min-h-[400px] p-6">
                            <div className="flex gap-2 mb-6 overflow-x-auto no-scrollbar">
                                {INVENTORY_TABS.map(tab => (
                                    <button 
                                        type="button"
                                        key={tab.id} 
                                        onClick={() => setInventoryTab(tab.id)}
                                        className={`px-4 py-2 rounded-lg text-xs font-bold whitespace-nowrap transition-colors ${inventoryTab === tab.id ? 'bg-black text-white' : 'bg-gray-100 text-gray-400'}`}
                                    >
                                        {tab.label}
                                    </button>
                                ))}
                            </div>

                            <div className="grid grid-cols-2 gap-3 pb-24">
                                {currentFilteredWardrobe.map(item => renderItemCard(
                                    item, 
                                    (clickedItem) => setOutfit(prev => ({...prev, [clickedItem.slot]: clickedItem})), 
                                    outfit[item.slot]?.id === item.id
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>