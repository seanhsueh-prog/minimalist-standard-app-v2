<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Minimalist Wardrobe V27 - Source of Truth</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 基礎樣式 - 繼承自 V26.5 尺寸標準 */
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; 
            -webkit-font-smoothing: antialiased; 
            background-color: #111; 
            color: #111; 
            margin: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center; 
            align-items: flex-start;
        }
        
        .app-container {
            width: 100%;
            max-width: 480px; 
            height: 100vh; 
            background-color: #ffffff;
            position: relative;
            box-shadow: 0 0 60px rgba(0,0,0,0.6);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .content-area {
            flex: 1;
            overflow-y: auto;
            padding-bottom: 90px; 
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .content-area::-webkit-scrollbar { display: none; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in { animation: fade-in 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards; }

        /* Ghost Engine - 視覺對齊核心 */
        .ghost-canvas-container {
            position: relative;
            width: 100%;
            aspect-ratio: 4 / 5; 
            background-color: #f9fafb;
            overflow: hidden;
            border-bottom: 1px solid #f0f0f0;
        }

        .ghost-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: contain; 
            object-position: bottom center;
            pointer-events: none;
            transition: opacity 0.3s ease-in-out;
            will-change: transform, opacity; 
        }

        /* 渲染層級 (Z-Index) & 鞋子縮放 (Scale 3.8) */
        .layer-shoes { z-index: 10; transform: scale(3.8); transform-origin: bottom center; }
        .layer-bottom { z-index: 20; }
        .layer-inner { z-index: 30; }
        .layer-outer { z-index: 40; }

        /* Floating Controls */
        .floating-controls {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-40%); 
            display: flex;
            flex-direction: column;
            gap: 12px;
            z-index: 50;
        }
        .control-group {
            display: flex;
            flex-direction: column;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(8px);
            border-radius: 99px; 
            padding: 4px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            border: 1px solid rgba(255,255,255,0.5);
        }
        .mini-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 700;
            color: #9ca3af;
            transition: all 0.2s;
            cursor: pointer;
        }
        .mini-btn.active { background-color: #000; color: #fff; transform: scale(1.05); }

        /* 網格與標籤優化 */
        .item-card {
            background: #fff;
            border-radius: 12px;
            border: 1px solid #f3f4f6;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: all 0.2s;
        }
        .item-image-box {
            aspect-ratio: 1/1;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fafafa;
            position: relative;
        }
        .item-info {
            padding: 6px 8px;
            text-align: center;
            background: #fff;
        }
        .item-label {
            font-size: 10px;
            font-weight: 600;
            color: #374151;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* 顏色圓點切換器 */
        .color-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            border: 1px solid #eee;
            cursor: pointer;
            transition: transform 0.1s;
        }
        .color-dot.active { ring: 2px ring-offset-1 ring-black; transform: scale(1.1); }

        /* Bottom Nav */
        .bottom-nav {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid #eee;
            display: flex;
            justify-content: space-around;
            padding: 12px 0 24px 0; 
            z-index: 100;
        }
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            font-size: 10px;
            font-weight: 600;
            color: #9ca3af;
            cursor: pointer;
            flex: 1;
        }
        .nav-item.active { color: #000; }
    </style>
</head>
<body>
    <div id="root" class="w-full flex justify-center"></div>

    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useCallback } = React;

        // --- 1. RAW MANIFEST (92 實體檔案) ---
        const RAW_MANIFEST = [
            // 外套 (o_)
            "o_suits_bk_01.png", "o_suits_nv_01.png", "o_suitd_bk_01.png", "o_suitd_nv_01.png",
            "o_leather_bk_01.png", "o_leather_bk_02.png", "o_leather_bk_03.png", "o_leather_bk_04.png",
            "o_leather_br_01.png", "o_leather_br_02.png", "o_leather_br_03.png",
            "o_jacket_bk_01.png", "o_jacket_bk_03.png", "o_jacket_bk_04.png",
            "o_jacket_br_01.png", "o_jacket_br_02.png", "o_jacket_br_03.png",
            "o_jacket_gn_01.png", "o_jacket_gn_02.png", "o_jacket_gn_03.png",
            "o_jacket_gy_01.png", "o_jacket_gy_02.png", "o_jacket_gy_03.png", "o_jacket_gy_04.png",
            "o_jacket_nv_01.png", "o_jacket_nv_02.png", "o_jacket_nv_03.png",
            "o_down_gy_01.png", "o_down_nv_01.png", "o_down_wh_01.png",
            // 內搭 (i_)
            "i_knits_bk_01.png", "i_knits_gy_01.png", "i_knits_nv_01.png", "i_knits_wh_01.png",
            "i_knitn_bk_01.png", "i_knitn_gy_01.png", "i_knitn_nv_01.png", "i_knitn_wh_01.png",
            "i_shirts_bk_01.png", "i_shirts_nv_01.png", "i_shirts_wh_01.png", "i_shirts_wh_02.png",
            "i_shirtn_bk_01.png", "i_shirtn_nv_01.png", "i_shirtn_wh_01.png", "i_shirtn_wh_02.png",
            "i_sweats_bk_01.png", "i_sweats_gy_01.png", "i_sweats_nv_01.png",
            "i_tshirts_bk_01.png", "i_tshirts_gy_01.png", "i_tshirts_nv_01.png", "i_tshirts_wh_01.png",
            "i_tshirtn_bk_01.png", "i_tshirtn_gy_01.png", "i_tshirtn_nv_01.png", "i_tshirtn_wh_01.png",
            // 下身 (b_)
            "b_cargo_bk_01.png", "b_cargo_gn_01.png", "b_cargo_gy_01.png",
            "b_chino_be_01.png", "b_chino_bk_01.png", "b_chino_nv_01.png",
            "b_jeans_bk_01.png", "b_jeans_dm_01.png", "b_jeans_gy_01.png",
            "b_sport_bk_01.png", "b_sport_gy_01.png", "b_sport_nv_01.png",
            "b_suit_bk_01.png", "b_suit_gy_01.png", "b_suit_nv_01.png",
            // 鞋款 (s_)
            "s_dress_bk_01.png", "s_dress_br_01.png",
            "s_leasnk_bk_01.png", "s_leasnk_wh_01.png",
            "s_loafer_bk_01.png", "s_loafer_br_01.png",
            "s_sport_bk_01.png", "s_sport_gy_01.png", "s_sport_wh_01.png"
        ];

        // --- 2. CONFIG & HELPERS ---
        const DB_CONFIG = { name: 'Minimalist_Master_Vault', version: 1, store: 'inventory' };
        
        const PART_MAP = { o: '外套', i: '內搭', b: '下身', s: '鞋款' };
        const TYPE_MAP = {
            suits: '雙排西裝', suitd: '單排西裝', leather: '皮衣', jacket: '夾克', down: '羽絨',
            knits: '有袖針織', knitn: '無袖針織', shirts: '有袖襯衫', shirtn: '無袖襯衫', sweats: '衛衣',
            tshirts: '有袖T', tshirtn: '無袖T', cargo: '工裝褲', chino: '卡其褲', jeans: '牛仔褲',
            sport: '運動褲', suit: '西裝褲', dress: '皮鞋', leasnk: '休閒皮鞋', loafer: '樂福鞋'
        };
        const COLOR_MAP = {
            bk: { name: '黑', hex: '#111' }, wh: { name: '白', hex: '#fff' }, gy: { name: '灰', hex: '#888' },
            nv: { name: '深藍', hex: '#1e3a8a' }, br: { name: '棕', hex: '#78350f' }, gn: { name: '綠', hex: '#166534' },
            be: { name: '大地', hex: '#d4b483' }, dm: { name: '丹寧', hex: '#4f83cc' }
        };

        const STYLE_LOGIC = {
            'suits': ['Formal', 'Smart'], 'suitd': ['Formal', 'Smart'], 'suit': ['Formal', 'Smart'], 'dress': ['Formal', 'Smart'],
            'leather': ['Smart', 'Casual'], 'jacket': ['Smart', 'Casual'], 'knits': ['Smart', 'Casual'], 'knitn': ['Smart', 'Casual'],
            'chino': ['Smart', 'Casual'], 'jeans': ['Smart', 'Casual'], 'leasnk': ['Smart', 'Casual'], 'loafer': ['Smart', 'Casual'],
            'tshirts': ['Casual'], 'tshirtn': ['Casual'], 'sweats': ['Casual'], 'cargo': ['Casual'], 'sport': ['Casual']
        };

        const parseFileName = (fn) => {
            const p = fn.replace('.png', '').split('_');
            return {
                fileName: fn,
                part: p[0],
                type: p[1],
                color: p[2],
                id: p[3],
                displayName: `${TYPE_MAP[p[1]] || p[1]} / ${COLOR_MAP[p[2]]?.name || p[2]}`,
                style: STYLE_LOGIC[p[1]] || ['Casual']
            };
        };

        const dbHelper = {
            open: () => new Promise((res, rej) => {
                const req = indexedDB.open(DB_CONFIG.name, DB_CONFIG.version);
                req.onupgradeneeded = (e) => e.target.result.createObjectStore(DB_CONFIG.store, { keyPath: 'id', autoIncrement: true });
                req.onsuccess = () => res(req.result);
                req.onerror = () => rej(req.error);
            }),
            save: async (item) => {
                const db = await dbHelper.open();
                return new Promise((res) => {
                    const tx = db.transaction(DB_CONFIG.store, 'readwrite');
                    tx.objectStore(DB_CONFIG.store).add(item).onsuccess = res;
                });
            },
            getAll: async () => {
                const db = await dbHelper.open();
                return new Promise((res) => {
                    const tx = db.transaction(DB_CONFIG.store, 'readonly');
                    tx.objectStore(DB_CONFIG.store).getAll().onsuccess = (e) => res(e.target.result);
                });
            },
            delete: async (id) => {
                const db = await dbHelper.open();
                const tx = db.transaction(DB_CONFIG.store, 'readwrite');
                tx.objectStore(DB_CONFIG.store).delete(id);
            }
        };

        // --- 3. UI COMPONENTS ---

        const Icon = ({ name, className }) => {
            const icons = {
                hanger: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 2a5 5 0 0 1 4.9 6H7.1a5 5 0 0 1 4.9-6Z"/><path d="M21 21H3V11c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2v10Z"/></svg>,
                grid: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>,
                plus: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 5v14M5 12h14"/></svg>,
                dice: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="8" cy="8" r="1.5" fill="currentColor"/><circle cx="16" cy="16" r="1.5" fill="currentColor"/><circle cx="8" cy="16" r="1.5" fill="currentColor"/><circle cx="16" cy="8" r="1.5" fill="currentColor"/></svg>,
                trash: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/></svg>
            };
            return icons[name] ? React.cloneElement(icons[name], { className }) : null;
        };

        const GhostEngine = ({ outfit, occasion, setOccasion, season, setSeason, triggerRandom }) => {
            return (
                <div className="ghost-canvas-container animate-fade-in">
                    {/* Z-Index & Scale 執行 */}
                    {outfit.s && <img src={`./${outfit.s.fileName}`} className="ghost-layer layer-shoes" alt="Shoes" />}
                    {outfit.b && <img src={`./${outfit.b.fileName}`} className="ghost-layer layer-bottom" alt="Bottom" />}
                    {outfit.i && <img src={`./${outfit.i.fileName}`} className="ghost-layer layer-inner" alt="Inner" />}
                    {outfit.o && <img src={`./${outfit.o.fileName}`} className="ghost-layer layer-outer" alt="Outer" />}

                    {/* Floating Control Stack */}
                    <div className="floating-controls">
                        <div className="control-group">
                            {['Winter', 'Summer'].map(s => (
                                <button key={s} className={`mini-btn ${season === s ? 'active' : ''}`} onClick={() => setSeason(s)}>
                                    {s === 'Winter' ? '冬' : '夏'}
                                </button>
                            ))}
                        </div>
                        <div className="control-group">
                            {['Formal', 'Smart', 'Casual'].map(occ => (
                                <button key={occ} className={`mini-btn ${occasion === occ ? 'active' : ''}`} onClick={() => setOccasion(occ)}>
                                    {occ.slice(0, 2)}
                                </button>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        // --- 4. MAIN APP ---
        const App = () => {
            const [activeTab, setActiveTab] = useState('styling');
            const [wardrobe, setWardrobe] = useState([]);
            const [outfit, setOutfit] = useState({ o: null, i: null, b: null, s: null });
            const [occasion, setOccasion] = useState('Smart');
            const [season, setSeason] = useState('Winter');

            // Warehouse Filtering State
            const [whPart, setWhPart] = useState('o');
            const [whType, setWhType] = useState('suits');
            const [whColor, setWhColor] = useState('bk');

            // Closet Filter
            const [clPart, setClPart] = useState('o');

            useEffect(() => { loadWardrobe(); }, []);

            const loadWardrobe = async () => {
                const items = await dbHelper.getAll();
                setWardrobe(items);
            };

            const addToWardrobe = async (item) => {
                await dbHelper.save(item);
                await loadWardrobe();
            };

            const removeFromWardrobe = async (id) => {
                await dbHelper.delete(id);
                await loadWardrobe();
                setOutfit(prev => {
                    const next = {...prev};
                    Object.keys(next).forEach(k => { if(next[k]?.id === id) next[k] = null; });
                    return next;
                });
            };

            // V26.5 智慧穿搭結構
            const handleRandom = useCallback(() => {
                let newOutfit = { ...outfit };
                const parts = ['o', 'i', 'b', 's'];
                
                // 1. 季節排除 (夏季關閉外套與厚內搭)
                let skipOuter = false;
                if (season === 'Summer' && occasion !== 'Formal') skipOuter = true;

                parts.forEach(p => {
                    if (skipOuter && p === 'o') { newOutfit.o = null; return; }

                    let candidates = wardrobe.filter(item => item.part === p);
                    
                    // A. 場合過濾
                    candidates = candidates.filter(item => item.style.includes(occasion));

                    // B. 袖子聯動 (Sleeve Logic)
                    if (p === 'i') {
                        const hasOuter = !!newOutfit.o;
                        // o 存在則選無袖 (n), 否則選有袖 (s)
                        candidates = candidates.filter(item => hasOuter ? item.type.endsWith('n') : item.type.endsWith('s'));
                        if (season === 'Summer') candidates = candidates.filter(item => !['knits', 'sweats'].includes(item.type));
                    }

                    // C. 正式場合同色聯動 (Formal Match)
                    if (p === 'b' && occasion === 'Formal' && newOutfit.o && (newOutfit.o.type === 'suits' || newOutfit.o.type === 'suitd')) {
                        const matchedSuit = candidates.filter(item => item.type === 'suit' && item.color === newOutfit.o.color);
                        if (matchedSuit.length > 0) candidates = matchedSuit;
                    }

                    if (candidates.length > 0) {
                        newOutfit[p] = candidates[Math.floor(Math.random() * candidates.length)];
                    } else {
                        newOutfit[p] = null;
                    }
                });
                setOutfit(newOutfit);
            }, [wardrobe, occasion, season, outfit]);

            // Warehouse Logic
            const filteredWhItems = useMemo(() => {
                return RAW_MANIFEST.map(parseFileName).filter(item => 
                    item.part === whPart && item.type === whType && item.color === whColor
                );
            }, [whPart, whType, whColor]);

            const availableTypes = useMemo(() => {
                const all = RAW_MANIFEST.map(parseFileName).filter(i => i.part === whPart);
                return [...new Set(all.map(i => i.type))];
            }, [whPart]);

            const availableColors = useMemo(() => {
                const all = RAW_MANIFEST.map(parseFileName).filter(i => i.part === whPart && i.type === whType);
                return [...new Set(all.map(i => i.color))];
            }, [whPart, whType]);

            // 衣櫥分頁
            const filteredClosetItems = useMemo(() => {
                return wardrobe.filter(i => i.part === clPart);
            }, [wardrobe, clPart]);

            return (
                <div className="app-container">
                    <div className="px-6 pt-6 pb-2 bg-white flex justify-between items-center z-50">
                        <h1 className="text-lg font-black tracking-tighter">MINIMALIST <span className="text-[10px] bg-black text-white px-2 py-0.5 rounded-full">V27</span></h1>
                    </div>

                    <div className="content-area">
                        {/* TAB 1: STYLING */}
                        {activeTab === 'styling' && (
                            <div className="animate-fade-in">
                                <GhostEngine outfit={outfit} occasion={occasion} setOccasion={setOccasion} season={season} setSeason={setSeason} triggerRandom={handleRandom} />
                                <div className="px-6 mt-4">
                                    <div className="grid grid-cols-4 gap-2 mb-4">
                                        {['o','i','b','s'].map(p => (
                                            <div key={p} className={`aspect-square rounded-xl border-2 flex items-center justify-center relative overflow-hidden transition-all ${outfit[p] ? 'border-black bg-white' : 'border-dashed border-gray-200 bg-gray-50'}`}>
                                                {outfit[p] ? (
                                                    <img src={`./${outfit[p].fileName}`} className={`w-full h-full object-contain ${p === 's' ? 'scale-[3.8] origin-bottom' : 'p-1'}`} />
                                                ) : <span className="text-[9px] font-bold text-gray-300 uppercase">{PART_MAP[p]}</span>}
                                            </div>
                                        ))}
                                    </div>
                                    <div className="flex gap-2">
                                        <button onClick={() => setOutfit({o:null,i:null,b:null,s:null})} className="flex-1 py-4 bg-white border border-gray-200 rounded-2xl flex justify-center items-center gap-2 text-xs font-bold active:scale-95 transition-transform"><Icon name="trash" className="w-4 h-4"/> 重置</button>
                                        <button onClick={handleRandom} className="flex-[2.5] py-4 bg-black text-white rounded-2xl flex justify-center items-center gap-2 text-xs font-bold shadow-xl active:scale-95 transition-transform"><Icon name="dice" className="w-4 h-4"/> 智慧搭配</button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* TAB 2: CLOSET */}
                        {activeTab === 'closet' && (
                            <div className="p-6 animate-fade-in">
                                <h2 className="text-xl font-bold mb-4">我的衣櫥</h2>
                                <div className="flex gap-2 mb-6 overflow-x-auto no-scrollbar">
                                    {['o','i','b','s'].map(p => (
                                        <button key={p} onClick={() => setClPart(p)} className={`px-4 py-2 rounded-xl text-xs font-bold whitespace-nowrap ${clPart === p ? 'bg-black text-white' : 'bg-gray-100 text-gray-400'}`}>{PART_MAP[p]}</button>
                                    ))}
                                </div>
                                <div className="grid grid-cols-3 gap-3">
                                    {filteredClosetItems.map(item => (
                                        <div key={item.id} className="item-card relative" onClick={() => { setOutfit(prev => ({...prev, [item.part]: item})); setActiveTab('styling'); }}>
                                            <div className="item-image-box">
                                                <img src={`./${item.fileName}`} className={`w-full h-full object-contain ${item.part === 's' ? 'scale-[3.5] origin-bottom' : 'p-2'}`} />
                                            </div>
                                            <div className="item-info">
                                                <div className="item-label">{item.displayName}</div>
                                            </div>
                                            <button onClick={(e) => { e.stopPropagation(); removeFromWardrobe(item.id); }} className="absolute top-1 right-1 p-1 bg-white/80 rounded-full text-gray-300 hover:text-red-500"><Icon name="trash" className="w-3 h-3" /></button>
                                        </div>
                                    ))}
                                </div>
                                {filteredClosetItems.length === 0 && <div className="text-center py-20 text-gray-300 text-xs">該類別目前無單品</div>}
                            </div>
                        )}

                        {/* TAB 3: WAREHOUSE (三級過濾) */}
                        {activeTab === 'add' && (
                            <div className="p-6 animate-fade-in">
                                <h2 className="text-xl font-bold mb-4">單品倉庫</h2>
                                
                                {/* 1. 部位選擇 */}
                                <div className="flex gap-2 mb-4 overflow-x-auto no-scrollbar">
                                    {['o','i','b','s'].map(p => (
                                        <button key={p} onClick={() => { setWhPart(p); const items = RAW_MANIFEST.map(parseFileName).filter(i => i.part === p); setWhType(items[0].type); setWhColor(items[0].color); }} className={`px-4 py-1.5 rounded-lg text-xs font-bold border ${whPart === p ? 'bg-black text-white border-black' : 'bg-white text-gray-400 border-gray-200'}`}>{PART_MAP[p]}</button>
                                    ))}
                                </div>

                                {/* 2. 品項膠囊 */}
                                <div className="flex gap-2 mb-4 overflow-x-auto no-scrollbar py-1">
                                    {availableTypes.map(t => (
                                        <button key={t} onClick={() => { setWhType(t); const items = RAW_MANIFEST.map(parseFileName).filter(i => i.part === whPart && i.type === t); setWhColor(items[0].color); }} className={`px-3 py-1 rounded-full text-[10px] font-bold border transition-all ${whType === t ? 'bg-gray-800 text-white' : 'bg-gray-50 text-gray-400 border-gray-100'}`}>{TYPE_MAP[t] || t}</button>
                                    ))}
                                </div>

                                {/* 3. 顏色點點 */}
                                <div className="flex gap-4 mb-6 py-2 border-b border-gray-50">
                                    {availableColors.map(c => (
                                        <div key={c} onClick={() => setWhColor(c)} className={`color-dot ${whColor === c ? 'active' : ''}`} style={{ background: COLOR_MAP[c]?.hex || '#ccc' }}></div>
                                    ))}
                                    <span className="text-[10px] font-bold text-gray-400 ml-auto">{COLOR_MAP[whColor]?.name}</span>
                                </div>

                                {/* 結果網格 */}
                                <div className="grid grid-cols-2 gap-4 pb-12">
                                    {filteredWhItems.map((item, idx) => (
                                        <div key={idx} className="item-card cursor-pointer group" onClick={() => { addToWardrobe(item); alert('已加入衣櫥'); }}>
                                            <div className="item-image-box overflow-hidden">
                                                <img src={`./${item.fileName}`} className={`w-full h-full object-contain transition-transform group-hover:scale-110 ${item.part === 's' ? 'scale-[3.5] origin-bottom' : 'p-4'}`} />
                                                <div className="absolute inset-0 bg-black/5 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                                                    <div className="bg-black text-white text-[10px] px-3 py-1 rounded-full font-bold">新增</div>
                                                </div>
                                            </div>
                                            <div className="item-info">
                                                <div className="item-label">{item.displayName}</div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}
                    </div>

                    <div className="bottom-nav">
                        <div onClick={() => setActiveTab('styling')} className={`nav-item ${activeTab === 'styling' ? 'active' : ''}`}>
                            <Icon name="hanger" className="w-6 h-6" />
                            <span>搭配</span>
                        </div>
                        <div onClick={() => setActiveTab('closet')} className={`nav-item ${activeTab === 'closet' ? 'active' : ''}`}>
                            <Icon name="grid" className="w-6 h-6" />
                            <span>衣櫥</span>
                        </div>
                        <div onClick={() => setActiveTab('add')} className={`nav-item ${activeTab === 'add' ? 'active' : ''}`}>
                            <Icon name="plus" className="w-6 h-6" />
                            <span>倉庫</span>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>