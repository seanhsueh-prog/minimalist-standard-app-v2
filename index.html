<!-- minimalist-wardrobe-core_v28_4.html -->
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Minimalist V28.4 - Master Stable</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* [V28.4 - Visual System: Best of V28.2 + Logic of V26.5] */
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; 
            -webkit-font-smoothing: antialiased; 
            background-color: #111; 
            color: #111; 
            margin: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center; 
            align-items: flex-start;
        }
        
        .app-container {
            width: 100%;
            max-width: 480px; 
            height: 100vh; 
            background-color: #ffffff;
            position: relative;
            box-shadow: 0 0 60px rgba(0,0,0,0.6);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .content-area {
            flex: 1;
            overflow-y: auto;
            padding-bottom: 80px; 
            scrollbar-width: none;
        }
        .content-area::-webkit-scrollbar { display: none; }

        .ghost-canvas-container {
            position: relative;
            width: 100%;
            aspect-ratio: 4 / 5; 
            background-color: #f9fafb;
            overflow: hidden;
            border-bottom: 1px solid #f0f0f0;
        }

        .ghost-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: contain; 
            object-position: bottom center;
            pointer-events: none;
            transition: opacity 0.3s ease-in-out;
            will-change: transform, opacity; 
        }

        .floating-controls {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-40%); 
            display: flex;
            flex-direction: column;
            gap: 12px;
            z-index: 30;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(8px);
            border-radius: 99px; 
            padding: 4px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            border: 1px solid rgba(255,255,255,0.5);
        }

        .mini-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 700;
            color: #9ca3af;
            cursor: pointer;
            margin-bottom: 2px;
        }
        .mini-btn.active { background-color: #000; color: #fff; transform: scale(1.05); }

        /* Grid Visuals from V28.2 */
        .dense-card {
            aspect-ratio: 1/1;
            position: relative;
            background: #fff;
            border-radius: 0.75rem;
            border: 1px solid #f3f4f6;
            overflow: hidden; 
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .warehouse-item {
            aspect-ratio: 3/4;
            border: 1px solid #eee;
            border-radius: 12px;
            padding: 0; 
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            background: #fff;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .cat-pill {
            padding: 6px 12px;
            border-radius: 999px;
            font-size: 11px;
            font-weight: 600;
            white-space: nowrap;
            transition: all 0.2s;
            border: 1px solid #eee;
            cursor: pointer;
        }
        .cat-pill.active { background-color: #000; color: #fff; border-color: #000; }
        .cat-pill.inactive { background-color: #fff; color: #666; }

        .bottom-nav {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid #eee;
            display: flex;
            justify-content: space-around;
            padding: 12px 0 24px 0; 
            z-index: 50;
        }
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            font-size: 10px;
            font-weight: 600;
            color: #9ca3af;
            cursor: pointer;
            flex: 1;
        }
        .nav-item.active { color: #000; }

        .color-dot { width: 24px; height: 24px; border-radius: 50%; cursor: pointer; border: 1px solid #eee; transition: 0.2s; }
        .color-dot.active { ring: 2px solid black; ring-offset: 2px; transform: scale(1.15); }
    </style>
</head>
<body>
    <div id="root" class="w-full flex justify-center"></div>

    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useCallback } = React;

        // --- 1. CONFIG: GitHub Path (或本地 ./images/) ---
        const GITHUB_RAW_URL = "https://raw.githubusercontent.com/oaoxd/my-wardrobe/main/images";

        // --- 2. MANIFEST (92 FILES) ---
        const RAW_MANIFEST = [
            // Outer (34)
            "o_suits_bk_01.png", "o_suits_br_01.png", "o_suits_gy_01.png", "o_suits_nv_01.png",
            "o_suitd_bk_01.png", "o_suitd_br_01.png", "o_suitd_gy_01.png", "o_suitd_nv_01.png",
            "o_leather_bk_01.png", "o_leather_bk_02.png", "o_leather_bk_03.png", "o_leather_bk_04.png", 
            "o_leather_br_01.png", "o_leather_br_02.png", "o_leather_br_03.png",
            "o_jacket_bk_01.png", "o_jacket_bk_03.png", "o_jacket_bk_04.png",
            "o_jacket_br_01.png", "o_jacket_br_02.png", "o_jacket_br_03.png",
            "o_jacket_gn_01.png", "o_jacket_gn_02.png", "o_jacket_gn_03.png",
            "o_jacket_gy_01.png", "o_jacket_gy_02.png", "o_jacket_gy_03.png", "o_jacket_gy_04.png",
            "o_jacket_nv_01.png", "o_jacket_nv_02.png", "o_jacket_nv_03.png",
            "o_down_gy_01.png", "o_down_nv_01.png", "o_down_wh_01.png",
            // Inner (28)
            "i_knits_be_01.png", "i_knits_bk_01.png", "i_knits_br_01.png", "i_knits_gy_01.png", "i_knits_rd_01.png",
            "i_knitn_be_01.png", "i_knitn_bk_01.png", "i_knitn_br_01.png", "i_knitn_gy_01.png", "i_knitn_rd_01.png",
            "i_shirts_bk_01.png", "i_shirts_nv_01.png", "i_shirts_wh_01.png",
            "i_shirtn_bk_01.png", "i_shirtn_nv_01.png", "i_shirtn_wh_01.png",
            "i_sweats_bk_01.png", "i_sweats_gn_01.png", "i_sweats_gy_01.png", "i_sweats_nv_01.png", "i_sweats_wh_01.png",
            "i_tshirts_bk_01.png", "i_tshirts_gy_01.png", "i_tshirts_wh_01.png",
            "i_tshirtn_bk_01.png", "i_tshirtn_gy_01.png", "i_tshirtn_nv_01.png", "i_tshirtn_wh_01.png",
            // Bottom (20)
            "b_cargo_be_01.png", "b_cargo_bk_01.png", "b_cargo_gn_01.png",
            "b_chino_be_01.png", "b_jeans_bk_01.png", "b_jeans_nv_01.png",
            "b_sport_bk_01.png", "b_sport_gy_01.png", "b_sport_nv_01.png", "b_sport_wh_01.png",
            "b_suit_be_02.png", "b_suit_bk_01.png", "b_suit_bk_02.png", "b_suit_br_01.png", "b_suit_br_02.png", 
            "b_suit_gn_01.png", "b_suit_gn_02.png", "b_suit_gy_01.png", "b_suit_gy_02.png", "b_suit_nv_01.png",
            // Shoes (10)
            "s_dress_bk_01.png", "s_dress_br_01.png",
            "s_leasnk_bk_01.png", "s_leasnk_wh_01.png",
            "s_loafer_bk_01.png", "s_loafer_br_01.png", "s_loafer_nv_01.png",
            "s_sport_bk_01.png", "s_sport_gy_01.png", "s_sport_wh_01.png"
        ];

        // --- 3. UI MAPPINGS ---
        const UI_LABELS = {
            o: '外套', i: '內搭', b: '下身', s: '鞋款',
            suits: '單排西裝', suitd: '雙排西裝', leather: '皮衣', jacket: '夾克', down: '羽絨', coat: '大衣',
            knits: '針織毛衣', knitn: '針織背心', shirts: '襯衫', shirtn: '無袖襯衫', sweats: '圓領衛衣', tshirts: 'T-shirt', tshirtn: '無袖T',
            cargo: '工裝褲', chino: '卡其褲', jeans: '牛仔褲', sport: '運動', suit: '西裝褲',
            dress: '正式皮鞋', leasnk: '休閒皮鞋', loafer: '樂福鞋', sneaker: '球鞋', boots: '靴子',
            bk: '黑', wh: '白', gy: '灰', nv: '深藍', be: '米/大地', br: '棕', dn: '丹寧', gn: '軍綠', rd: '酒紅'
        };

        const SLOT_MAP = { 'o': 'outer', 'i': 'inner', 'b': 'bottom', 's': 'shoes' };
        const COLOR_HEX = { bk:'#1A1A1A', wh:'#f3f4f6', gy:'#6B7280', nv:'#1E3A8A', be:'#C3B091', br:'#5D4037', dn:'#3B82F6', gn:'#355E3B', rd:'#7F1D1D' };

        const STYLE_RULES = {
            'suits': ['Formal', 'Smart'], 'suitd': ['Formal', 'Smart'], 'leather': ['Smart', 'Casual'], 
            'jacket': ['Smart', 'Casual'], 'down': ['Casual'],
            'knits': ['Smart', 'Casual'], 'knitn': ['Smart', 'Casual'], 
            'shirts': ['Formal', 'Smart'], 'shirtn': ['Formal', 'Smart'],
            'sweats': ['Casual'], 'tshirts': ['Smart', 'Casual'], 'tshirtn': ['Smart', 'Casual'],
            'suit': ['Formal', 'Smart'], 'jeans': ['Smart', 'Casual'], 'chino': ['Smart', 'Casual'],
            'cargo': ['Casual'], 'sport': ['Casual'],
            'dress': ['Formal', 'Smart'], 'loafer': ['Formal', 'Smart'], 'leasnk': ['Smart', 'Casual'],
            'sport': ['Casual']
        };

        // --- 4. CORE PARSER ---
        const parseItem = (filename) => {
            const raw = filename.replace('.png', '');
            const parts = raw.split('_'); 
            if (parts.length < 4) return null;
            const [slotCode, catCode, colorCode] = parts;
            
            let sleeve = 'standard';
            // i_...n 是無袖, i_...s 是有袖
            if (slotCode === 'i') {
                if (catCode.endsWith('n')) sleeve = 'sleeveless';
                else sleeve = 'sleeved';
            }

            return {
                id: raw,
                filename: filename,
                displayUrl: GITHUB_RAW_URL ? `${GITHUB_RAW_URL}/${filename}` : `./images/${filename}`,
                slot: SLOT_MAP[slotCode] || 'unknown',
                catCode, color: colorCode, sleeve,
                label: UI_LABELS[catCode] || catCode,
                colorLabel: UI_LABELS[colorCode] || colorCode
            };
        };

        const SYSTEM_STOCK = RAW_MANIFEST.map(parseItem).filter(Boolean);

        // --- 5. DATABASE ---
        const DB_CONFIG = { name: 'Minimalist_Global_Vault', version: 1, store: 'inventory' };
        const dbHelper = {
            open: () => new Promise(r => {
                const req = indexedDB.open(DB_CONFIG.name, DB_CONFIG.version);
                req.onupgradeneeded = e => e.target.result.createObjectStore(DB_CONFIG.store, { keyPath: 'uuid', autoIncrement: true });
                req.onsuccess = e => r(e.target.result);
            }),
            getAll: async () => {
                const db = await dbHelper.open();
                return new Promise(r => {
                    const req = db.transaction(DB_CONFIG.store, 'readonly').objectStore(DB_CONFIG.store).getAll();
                    req.onsuccess = () => r(req.result);
                });
            },
            add: async (item) => {
                const db = await dbHelper.open();
                const tx = db.transaction(DB_CONFIG.store, 'readwrite');
                tx.objectStore(DB_CONFIG.store).add({ ...item, addedAt: Date.now() });
                return new Promise(r => tx.oncomplete = r);
            },
            del: async (uuid) => {
                const db = await dbHelper.open();
                const tx = db.transaction(DB_CONFIG.store, 'readwrite');
                tx.objectStore(DB_CONFIG.store).delete(uuid);
                return new Promise(r => tx.oncomplete = r);
            }
        };

        // --- 6. UI COMPONENTS ---
        const Icon = ({ name, className }) => {
            const icons = {
                hanger: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 2a5 5 0 0 1 4.9 6H7.1a5 5 0 0 1 4.9-6Z"/><path d="M21 21H3V11c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2v10Z"/></svg>,
                grid: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>,
                plus: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 5v14M5 12h14"/></svg>,
                trash: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>,
                dice: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="8" cy="8" r="1.5" fill="currentColor"/><circle cx="16" cy="16" r="1.5" fill="currentColor"/></svg>,
                x: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            };
            return icons[name] ? React.cloneElement(icons[name], { className }) : null;
        };

        const App = () => {
            const [wardrobe, setWardrobe] = useState([]);
            const [outfit, setOutfit] = useState({ outer: null, inner: null, bottom: null, shoes: null });
            const [activeTab, setActiveTab] = useState('styling');
            const [occasion, setOccasion] = useState('Smart');
            const [season, setSeason] = useState('Winter');

            // Filters
            const [whSlot, setWhSlot] = useState('o');
            const [whCat, setWhCat] = useState('all');
            const [whColor, setWhColor] = useState('all');
            const [closetSlot, setClosetSlot] = useState('o');

            const loadData = async () => setWardrobe(await dbHelper.getAll());
            useEffect(() => { loadData(); }, []);

            // [RESTORE V26.5 LOGIC]
            const handleRandom = (targetOcc, targetSea) => {
                const newOutfit = { ...outfit };
                
                const getRandom = (slot, occ, sea, current) => {
                    let pool = wardrobe.filter(i => i.slot === slot);
                    pool = pool.filter(i => i.style && i.style.includes(occ));
                    
                    if (slot === 'inner') {
                        const hasOuter = current.outer;
                        // 有外套選無袖 (n), 沒外套選有袖 (s/standard)
                        pool = pool.filter(i => hasOuter ? i.sleeve === 'sleeveless' : i.sleeve === 'sleeved');
                        if (sea === 'Summer') pool = pool.filter(i => !['knits','sweats','knitn'].includes(i.catCode));
                    }
                    return pool.length ? pool[Math.floor(Math.random() * pool.length)] : null;
                };

                // 夏季過濾
                if (targetSea === 'Summer' && targetOcc !== 'Formal') newOutfit.outer = null;
                else newOutfit.outer = getRandom('outer', targetOcc, targetSea, newOutfit);

                // 西裝對齊邏輯
                if (targetOcc === 'Formal' && newOutfit.outer?.catCode.startsWith('suit')) {
                    newOutfit.bottom = wardrobe.find(b => b.slot === 'bottom' && b.catCode === 'suit' && b.color === newOutfit.outer.color) || getRandom('bottom', targetOcc, targetSea, newOutfit);
                } else {
                    newOutfit.bottom = getRandom('bottom', targetOcc, targetSea, newOutfit);
                }

                newOutfit.inner = getRandom('inner', targetOcc, targetSea, newOutfit);
                newOutfit.shoes = getRandom('shoes', targetOcc, targetSea, newOutfit);
                
                setOutfit(newOutfit);
            };

            // [RESTORE V26.5 MOTHER SCALE]
            const getGhostStyle = (slot) => {
                const base = { width: '100%', height: '100%', objectFit: 'contain', objectPosition: 'bottom center' };
                if (slot === 'shoes') return { ...base, transform: 'scale(3.8) translateZ(0)', transformOrigin: 'bottom center' };
                return base;
            };

            const getGridStyle = (slot) => {
                const base = { width:'100%', height:'100%', objectFit:'contain' };
                if (slot === 'shoes') return { ...base, transform:'scale(3.5)', transformOrigin:'bottom' };
                if (slot === 'outer' || slot === 'inner') return { ...base, transform:'scale(1.5)', transformOrigin:'top' };
                return base;
            };

            const addToWardrobe = async sysItem => {
                await dbHelper.add({ ...sysItem, style: STYLE_RULES[sysItem.catCode] || ['Casual'] });
                await loadData();
                alert(`入庫成功：${sysItem.label}`);
            };

            const removeFromWardrobe = async uuid => {
                if(!confirm("確定移除?")) return;
                await dbHelper.del(uuid); await loadData();
                setOutfit(p => { const n={...p}; Object.keys(n).forEach(k=>{if(n[k]?.uuid===uuid) n[k]=null;}); return n; });
            };

            const availCats = useMemo(() => ['all', ...new Set(SYSTEM_STOCK.filter(i => i.slot === SLOT_MAP[whSlot]).map(i => i.catCode))], [whSlot]);
            const availColors = useMemo(() => {
                let pool = SYSTEM_STOCK.filter(i => i.slot === SLOT_MAP[whSlot]);
                if (whCat !== 'all') pool = pool.filter(i => i.catCode === whCat);
                return ['all', ...new Set(pool.map(i => i.color))];
            }, [whSlot, whCat]);

            const filteredStock = useMemo(() => {
                return SYSTEM_STOCK.filter(i => {
                    if (i.slot !== SLOT_MAP[whSlot]) return false;
                    if (whCat !== 'all' && i.catCode !== whCat) return false;
                    if (whColor !== 'all' && i.color !== whColor) return false;
                    return true;
                });
            }, [whSlot, whCat, whColor]);

            return (
                <div className="app-container">
                    <div className="px-6 pt-6 pb-2 bg-white border-b border-gray-100 flex justify-between items-center z-10 sticky top-0">
                        <h1 className="text-lg font-bold tracking-tighter">Minimalist <span className="bg-black text-white text-[10px] px-2 py-0.5 rounded-full shadow-sm">V28.4 MASTER</span></h1>
                    </div>

                    <div className="content-area bg-gray-50">
                        {/* 1. STYLING (Ghost Engine Restoration) */}
                        {activeTab === 'styling' && (
                            <div className="animate-fade-in">
                                <div className="ghost-canvas-container mx-auto relative bg-white">
                                    {outfit.shoes && <img src={outfit.shoes.displayUrl} className="ghost-layer z-10" style={getGhostStyle('shoes')} />}
                                    {outfit.bottom && <img src={outfit.bottom.displayUrl} className="ghost-layer z-20" style={getGhostStyle('bottom')} />}
                                    {outfit.inner && <img src={outfit.inner.displayUrl} className="ghost-layer z-30" style={getGhostStyle('inner')} />}
                                    {outfit.outer && <img src={outfit.outer.displayUrl} className="ghost-layer z-40" style={getGhostStyle('outer')} />}
                                    {(!outfit.outer && !outfit.inner && !outfit.bottom && !outfit.shoes) && <div className="absolute inset-0 flex items-center justify-center text-gray-300 text-xs tracking-widest uppercase">Select Item</div>}
                                </div>

                                <div className="floating-controls">
                                    <div className="control-group mb-3">
                                        {['Winter','Summer'].map(s => (
                                            <button key={s} className={`mini-btn ${season === s ? 'active' : ''}`} onClick={() => { setSeason(s); handleRandom(occasion, s); }}>{UI_LABELS[s==='Winter'?'bk':'wh']}</button>
                                        ))}
                                    </div>
                                    <div className="control-group">
                                        {['Formal','Smart','Casual'].map(o => (
                                            <button key={o} className={`mini-btn ${occasion === o ? 'active' : ''}`} onClick={() => { setOccasion(o); handleRandom(o, season); }}>{UI_LABELS[o==='Formal'?'suits':'jacket'].slice(0,1)}</button>
                                        ))}
                                    </div>
                                </div>

                                <div className="px-6 mt-4">
                                    <div className="grid grid-cols-4 gap-2 mb-4">
                                        {['outer','inner','bottom','shoes'].map(slot => (
                                            <div key={slot} className="relative aspect-square rounded-xl border flex items-center justify-center overflow-hidden bg-white shadow-sm border-gray-100">
                                                {outfit[slot] ? <img src={outfit[slot].displayUrl} style={getGridStyle(slot)} /> : <span className="text-[10px] text-gray-200 font-bold uppercase">{UI_LABELS[slot[0]]}</span>}
                                                {outfit[slot] && <button onClick={()=>setOutfit(p=>({...p,[slot]:null}))} className="absolute top-0 right-0 p-1 bg-white/80 rounded-bl-lg shadow-sm"><Icon name="x" className="w-3 text-gray-400"/></button>}
                                            </div>
                                        ))}
                                    </div>
                                    <button onClick={()=>handleRandom(occasion, season)} className="w-full py-4 bg-black text-white rounded-2xl text-xs font-bold flex items-center justify-center gap-2 shadow-xl active:scale-95 transition-transform"><Icon name="dice" className="w-4 h-4"/> 智慧搭配</button>
                                </div>
                            </div>
                        )}

                        {/* 2. CLOSET (Categorized Tabs) */}
                        {activeTab === 'closet' && (
                            <div className="p-6 bg-white min-h-full">
                                <h2 className="text-xl font-bold mb-4">我的衣櫥 ({wardrobe.length})</h2>
                                <div className="flex gap-2 mb-6 overflow-x-auto no-scrollbar">
                                    {['o','i','b','s'].map(s => (
                                        <button key={s} onClick={()=>setClosetSlot(s)} className={`px-4 py-2 rounded-lg text-xs font-bold whitespace-nowrap transition-colors ${closetSlot === s ? 'bg-black text-white' : 'bg-gray-100 text-gray-400'}`}>{UI_LABELS[s]}</button>
                                    ))}
                                </div>
                                <div className="grid grid-cols-3 gap-2">
                                    {wardrobe.filter(i => i.slot === SLOT_MAP[closetSlot]).map(item => (
                                        <div key={item.uuid} className="dense-card group" onClick={()=>{setOutfit(p=>({...p,[item.slot]:item}));setActiveTab('styling');}}>
                                            <img src={item.displayUrl} style={getGridStyle(item.slot)} />
                                            <div className="absolute bottom-1 right-1 w-2 h-2 rounded-full border" style={{background: COLOR_HEX[item.color]}}></div>
                                            <button onClick={e=>{e.stopPropagation(); removeFromWardrobe(item.uuid);}} className="absolute top-1 right-1 p-1 bg-white/80 rounded-full text-gray-300 hover:text-red-500 shadow-sm"><Icon name="trash" className="w-3 h-3"/></button>
                                        </div>
                                    ))}
                                </div>
                                {wardrobe.filter(i => i.slot === SLOT_MAP[closetSlot]).length === 0 && <div className="text-center py-20 text-gray-200 text-xs uppercase tracking-widest">No Items</div>}
                            </div>
                        )}

                        {/* 3. WAREHOUSE (V27.8 Filters) */}
                        {activeTab === 'add' && (
                            <div className="p-6 bg-white min-h-full">
                                <h2 className="text-xl font-bold mb-4">單品倉庫</h2>
                                <div className="flex gap-2 mb-4 overflow-x-auto no-scrollbar">
                                    {['o','i','b','s'].map(s => (
                                        <button key={s} onClick={()=>setWhSlot(s)} className={`px-4 py-2 rounded-lg text-xs font-bold border ${whSlot===s?'bg-black text-white border-black':'bg-white text-gray-400 border-gray-100'}`}>{UI_LABELS[s]}</button>
                                    ))}
                                </div>
                                <div className="flex gap-2 mb-4 overflow-x-auto no-scrollbar pb-1">
                                    {availCats.map(c => (
                                        <button key={c} onClick={()=>setWhCat(c)} className={`cat-pill ${whCat===c?'active':'inactive'}`}>{c === 'all' ? '全部品項' : UI_LABELS[c]}</button>
                                    ))}
                                </div>
                                <div className="flex gap-3 mb-6 overflow-x-auto no-scrollbar py-1 items-center">
                                    <button onClick={()=>setWhColor('all')} className={`text-[10px] font-bold px-2 ${whColor==='all'?'text-black':'text-gray-300'}`}>ALL</button>
                                    {availColors.filter(c=>c!=='all').map(c => (
                                        <div key={c} onClick={()=>setWhColor(c)} className={`color-dot ${whColor === c ? 'active' : ''}`} style={{background: COLOR_HEX[c]}}></div>
                                    ))}
                                </div>

                                <div className="grid grid-cols-2 gap-3 pb-24">
                                    {filteredStock.map((item, idx) => (
                                        <div key={idx} onClick={()=>addToWardrobe(item)} className="warehouse-item group p-2 bg-gray-50 border-dashed border-2 hover:border-black">
                                            <img src={item.displayUrl} style={getGridStyle(item.slot)} />
                                            <div className="text-[9px] mt-1 font-bold text-gray-400 uppercase tracking-tighter">{item.label} / {item.colorLabel}</div>
                                            <div className="absolute inset-0 bg-black/5 opacity-0 group-hover:opacity-100 flex items-center justify-center transition-opacity">
                                                <span className="bg-black text-white text-[10px] px-3 py-1.5 rounded-full font-bold shadow-lg">入庫</span>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}
                    </div>

                    <div className="bottom-nav">
                        <div onClick={()=>setActiveTab('styling')} className={`nav-item ${activeTab==='styling'?'active':''}`}><Icon name="hanger" className="w-6 h-6"/><span>搭配</span></div>
                        <div onClick={()=>setActiveTab('closet')} className={`nav-item ${activeTab==='closet'?'active':''}`}><Icon name="grid" className="w-6 h-6"/><span>衣櫥</span></div>
                        <div onClick={()=>setActiveTab('add')} className={`nav-item ${activeTab==='add'?'active':''}`}><Icon name="plus" className="w-6 h-6"/><span>倉庫</span></div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>